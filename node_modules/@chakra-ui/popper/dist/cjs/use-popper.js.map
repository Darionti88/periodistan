{"version":3,"sources":["../../src/use-popper.ts"],"names":["defaultProps","placement","strategy","flip","gutter","arrowPadding","preventOverflow","eventListeners","modifiers","boundary","usePopper","props","opts","Object","assign","placementProp","offset","matchWidth","reference","popper","instanceRef","cleanup","setupPopper","current","concat","popperModifiers","innerArrow","positionArrow","transformOrigin","enabled","name","options","padding","forceUpdate","destroy","update","referenceRef","node","popperRef"],"mappings":"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","sourcesContent":["import { filterUndefined } from \"@chakra-ui/utils\"\nimport {\n  createPopper,\n  Instance,\n  Modifier,\n  Placement,\n  VirtualElement,\n} from \"@popperjs/core\"\nimport { useCallback, useEffect, useMemo, useRef } from \"react\"\nimport * as popperModifiers from \"./modifiers\"\nimport { getEventListenerOptions } from \"./utils\"\n\nexport type { Placement }\n\nexport interface UsePopperProps {\n  offset?: [x: number, y: number]\n  gutter?: number\n  preventOverflow?: boolean\n  flip?: boolean\n  matchWidth?: boolean\n  boundary?: \"clippingParents\" | \"scrollParent\" | HTMLElement\n  eventListeners?: boolean | { scroll?: boolean; resize?: boolean }\n  arrowPadding?: number\n  strategy?: \"absolute\" | \"fixed\"\n  placement?: Placement\n  modifiers?: Array<Partial<Modifier<string, any>>>\n}\n\nconst defaultProps: UsePopperProps = {\n  placement: \"bottom\",\n  strategy: \"absolute\",\n  flip: true,\n  gutter: 8,\n  arrowPadding: 8,\n  preventOverflow: true,\n  eventListeners: true,\n  modifiers: [],\n  boundary: \"clippingParents\",\n}\n\nexport function usePopper(props: UsePopperProps = {}) {\n  const opts = Object.assign({}, defaultProps, filterUndefined(props))\n  const {\n    modifiers = [],\n    placement: placementProp,\n    strategy,\n    arrowPadding,\n    eventListeners,\n    offset,\n    gutter,\n    flip,\n    boundary,\n    preventOverflow,\n    matchWidth,\n  } = opts\n\n  const reference = useRef<Element | VirtualElement | null>(null)\n  const popper = useRef<HTMLElement | null>(null)\n  const instanceRef = useRef<Instance | null>(null)\n\n  const cleanup = useRef(() => {})\n\n  const setupPopper = useCallback(() => {\n    if (!reference.current || !popper.current) return\n    cleanup.current?.()\n\n    instanceRef.current = createPopper(reference.current, popper.current, {\n      placement: placementProp,\n      modifiers: modifiers.concat([\n        popperModifiers.innerArrow,\n        popperModifiers.positionArrow,\n        popperModifiers.transformOrigin,\n        { ...popperModifiers.matchWidth, enabled: !!matchWidth },\n        {\n          name: \"eventListeners\",\n          ...getEventListenerOptions(eventListeners),\n        },\n        {\n          name: \"arrow\",\n          options: { padding: arrowPadding },\n        },\n        {\n          name: \"offset\",\n          options: {\n            offset: offset ?? [0, gutter],\n          },\n        },\n        {\n          name: \"flip\",\n          enabled: !!flip,\n          options: { padding: 8 },\n        },\n        {\n          name: \"preventOverflow\",\n          enabled: !!preventOverflow,\n          options: { boundary },\n        },\n      ]),\n      strategy,\n    })\n\n    // force update one-time to fix any positioning issues\n    instanceRef.current.forceUpdate()\n\n    cleanup.current = instanceRef.current.destroy\n  }, [\n    placementProp,\n    modifiers,\n    matchWidth,\n    eventListeners,\n    arrowPadding,\n    offset,\n    gutter,\n    flip,\n    preventOverflow,\n    boundary,\n    strategy,\n  ])\n\n  useEffect(() => {\n    return () => {\n      instanceRef.current?.destroy()\n      instanceRef.current = null\n    }\n  }, [])\n\n  return useMemo(\n    () => ({\n      update: instanceRef.current?.update,\n      forceUpdate: instanceRef.current?.forceUpdate,\n      referenceRef: <T extends Element | VirtualElement>(node: T | null) => {\n        reference.current = node\n        setupPopper()\n      },\n      popperRef: <T extends HTMLElement>(node: T | null) => {\n        popper.current = node\n        setupPopper()\n      },\n    }),\n    [setupPopper],\n  )\n}\n\nexport type UsePopperReturn = ReturnType<typeof usePopper>\n"],"file":"use-popper.js"}